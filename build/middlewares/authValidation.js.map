{"version":3,"file":"authValidation.js","names":["signUpSchema","Joi","object","name","string","min","max","required","email","pattern","RegExp","password","exports","validateSignUp","req","res","next","validate","body","error","value","errorMsg","details","path","message","status","send","validateUniqueUser","User","findOne","existingEmail"],"sources":["../../src/middlewares/authValidation.js"],"sourcesContent":["import Joi from \"joi\";\r\nimport User from \"../database/models/authentication\";\r\n\r\nconst signUpSchema = Joi.object({\r\n  name: Joi.string().min(2).max(30).required(),\r\n  email: Joi.string().pattern(\r\n    new RegExp(\r\n      /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/\r\n    )\r\n  ),\r\n  password: Joi.string().pattern(\r\n    new RegExp(\"^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})\")\r\n  ),\r\n});\r\n\r\nexports.validateSignUp = (req, res, next) => {\r\n  const { error, value } = signUpSchema.validate(req.body);\r\n  if (error) {\r\n    let errorMsg;\r\n    if (error.details[0].path[0] === \"email\") {\r\n      errorMsg = `Invalid email address`;\r\n    }\r\n    if (error.details[0].path[0] === \"password\") {\r\n      errorMsg = `weak password`;\r\n    } else {\r\n      errorMsg = error.details[0].message;\r\n    }\r\n    return res.status(400).send({ error: errorMsg });\r\n  }\r\n  next();\r\n};\r\n\r\nexports.validateUniqueUser = async (req, res, next) => {\r\n  const existingEmail = await User?.findOne({ email: req.body.email });\r\n  if (existingEmail) {\r\n    return res.status(409).send({\r\n      message: `User with ${existingEmail?.email} already exists`,\r\n    });\r\n  }\r\n  next();\r\n};"],"mappings":";;;AAAA;AACA;AAAqD;AAAA,+CAArD;AAAA;AAAA;AAEA,IAAMA,YAAY,GAAGC,eAAG,CAACC,MAAM,CAAC;EAC9BC,IAAI,EAAEF,eAAG,CAACG,MAAM,EAAE,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,EAAE,CAAC,CAACC,QAAQ,EAAE;EAC5CC,KAAK,EAAEP,eAAG,CAACG,MAAM,EAAE,CAACK,OAAO,CACzB,IAAIC,MAAM,CACR,sIAAsI,CACvI,CACF;EACDC,QAAQ,EAAEV,eAAG,CAACG,MAAM,EAAE,CAACK,OAAO,CAC5B,IAAIC,MAAM,CAAC,6DAA6D,CAAC;AAE7E,CAAC,CAAC;AAEFE,OAAO,CAACC,cAAc,GAAG,UAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAK;EAC3C,4BAAyBhB,YAAY,CAACiB,QAAQ,CAACH,GAAG,CAACI,IAAI,CAAC;IAAhDC,KAAK,yBAALA,KAAK;IAAEC,KAAK,yBAALA,KAAK;EACpB,IAAID,KAAK,EAAE;IACT,IAAIE,QAAQ;IACZ,IAAIF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,KAAK,OAAO,EAAE;MACxCF,QAAQ,0BAA0B;IACpC;IACA,IAAIF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;MAC3CF,QAAQ,kBAAkB;IAC5B,CAAC,MAAM;MACLA,QAAQ,GAAGF,KAAK,CAACG,OAAO,CAAC,CAAC,CAAC,CAACE,OAAO;IACrC;IACA,OAAOT,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEP,KAAK,EAAEE;IAAS,CAAC,CAAC;EAClD;EACAL,IAAI,EAAE;AACR,CAAC;AAEDJ,OAAO,CAACe,kBAAkB;EAAA,sEAAG,iBAAOb,GAAG,EAAEC,GAAG,EAAEC,IAAI;IAAA;IAAA;MAAA;QAAA;UAAA;UAAA,OACpBY,0BAAI,aAAJA,0BAAI,uBAAJA,0BAAI,CAAEC,OAAO,CAAC;YAAErB,KAAK,EAAEM,GAAG,CAACI,IAAI,CAACV;UAAM,CAAC,CAAC;QAAA;UAA9DsB,aAAa;UAAA,KACfA,aAAa;YAAA;YAAA;UAAA;UAAA,iCACRf,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAC1BF,OAAO,sBAAeM,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEtB,KAAK;UAC5C,CAAC,CAAC;QAAA;UAEJQ,IAAI,EAAE;QAAC;QAAA;UAAA;MAAA;IAAA;EAAA,CACR;EAAA;IAAA;EAAA;AAAA"}